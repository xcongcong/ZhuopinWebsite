{"ast":null,"code":"import\"antd/es/button/style/css\";import _Button from\"antd/es/button\";import\"antd/es/form/style/css\";import _Form from\"antd/es/form\";import\"antd/es/input/style/css\";import _Input from\"antd/es/input\";import\"antd/es/message/style/css\";import _message from\"antd/es/message\";import _classCallCheck from\"D:/\\u524D\\u7AEF\\u9879\\u76EE/\\u5C1A\\u9633\\u4E92\\u52A8\\u5B98\\u7F51/official-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/\\u524D\\u7AEF\\u9879\\u76EE/\\u5C1A\\u9633\\u4E92\\u52A8\\u5B98\\u7F51/official-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"D:/\\u524D\\u7AEF\\u9879\\u76EE/\\u5C1A\\u9633\\u4E92\\u52A8\\u5B98\\u7F51/official-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"D:/\\u524D\\u7AEF\\u9879\\u76EE/\\u5C1A\\u9633\\u4E92\\u52A8\\u5B98\\u7F51/official-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'./index.css';import close from'./images/guanbi.png';import memoryUtils from'../../utils/memoryUtils';import PubSub from'pubsub-js';//引入发布消息\nimport{reqLogin}from'../../api/index';//请求登陆的promise函数\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(){var _this;_classCallCheck(this,Login);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:''};_this.CloseLogin=function(){// alert('关闭')\nPubSub.publish('Close-login',false);//发布消息\n};_this.onFinish=function(values){//表单验证成功的回调\nvar username=values.username,password=values.password;// console.log(username,password)\nif(values){//不写判断不能.then\nreqLogin(username,password).then(function(response){var result=response.data.status;if(result===0){//密码正确跳转后台\nvar user=response.data.data;memoryUtils.user=user;//保存到内存中\n_message.success('登陆成功');console.log('用户信息',memoryUtils.user);_this.state.data.history.replace('/admin');}else{_message.error('用户名或密码错误');}});}// message.success('登陆成功')\n// //replace跳转到页面\n// \n};_this.onFinishFailed=function(errorInfo){console.log(errorInfo);_message.error('登陆出错,请重试');};return _this;}_createClass(Login,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;PubSub.subscribe('tiaozhuan',function(msg,data){_this2.setState({data:data});});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(\"div\",{className:\"login-bg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-content\",children:[/*#__PURE__*/_jsx(\"img\",{src:close,alt:\"guanbi\",onClick:this.CloseLogin}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u7528\\u6237\\u767B\\u9646\"}),/*#__PURE__*/_jsxs(_Form,{// layout='inline'\nlabelAlign:\"left\",name:\"basic\",labelCol:{span:7},wrapperCol:{span:20},initialValues:{remember:true},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,autoComplete:\"off\",children:[/*#__PURE__*/_jsx(_Form.Item,{label:\"\\u8D26\\u6237\",name:\"username\",rules:[{required:true,message:'用户名不能为空!'},{min:4,message:'用户名不低于四位'},{max:12,message:'用户名最长不高于十二位'},{pattern:/^[a-zA-Z0-9_]+$/,message:'用户名必须是英文、数字或下划线组成'}],children:/*#__PURE__*/_jsx(_Input,{})}),/*#__PURE__*/_jsx(_Form.Item,{label:\"\\u5BC6\\u7801\",name:\"password\",rules:[{required:true,message:'密码不能为空！'},{min:4,message:'密码不低于四位'},{max:12,message:'密码最长不高于十二位'},{pattern:/^[a-zA-Z0-9_]+$/,message:'密码必须是英文、数字或下划线组成'}],children:/*#__PURE__*/_jsx(_Input.Password,{})}),/*#__PURE__*/_jsx(_Form.Item,{wrapperCol:{offset:8,span:16},children:/*#__PURE__*/_jsx(_Button,{type:\"primary\",htmlType:\"submit\",className:\"login-form-button\",children:\"\\u767B\\u9646\"})})]})]})});}}]);return Login;}(Component);export{Login as default};","map":{"version":3,"sources":["D:/前端项目/尚阳互动官网/official-website/src/components/login/index.jsx"],"names":["React","Component","close","memoryUtils","PubSub","reqLogin","Login","state","data","CloseLogin","publish","onFinish","values","username","password","then","response","result","status","user","success","console","log","history","replace","error","onFinishFailed","errorInfo","subscribe","msg","setState","span","remember","required","message","min","max","pattern","offset"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Form, Input, Button,message } from 'antd';\r\nimport './index.css'\r\nimport close from './images/guanbi.png'\r\nimport memoryUtils from '../../utils/memoryUtils'\r\n\r\nimport PubSub from 'pubsub-js' //引入发布消息\r\n\r\nimport {reqLogin} from '../../api/index' //请求登陆的promise函数\r\n\r\nexport default class Login extends Component {\r\n            state = {\r\n                data:'',\r\n            }\r\n            componentDidMount(){\r\n                PubSub.subscribe('tiaozhuan',(msg,data)=>{\r\n                        this.setState({data})\r\n                        \r\n                })\r\n            }\r\n\r\n            CloseLogin=()=>{\r\n                // alert('关闭')\r\n                PubSub.publish('Close-login',false);  //发布消息\r\n            }\r\n            //---------------------------------------------------------------------------\r\n            onFinish = (values) => {   //表单验证成功的回调\r\n                const {username,password} = values;\r\n                // console.log(username,password)\r\n                if(values){  //不写判断不能.then\r\n                    reqLogin(username,password).then(response=>{\r\n                        const result =response.data.status\r\n                        if(result===0){//密码正确跳转后台\r\n                            const user =response.data.data\r\n                            memoryUtils.user = user;//保存到内存中\r\n                            message.success('登陆成功')\r\n                            console.log('用户信息',memoryUtils.user)\r\n                            this.state.data.history.replace('/admin')\r\n                        }else{\r\n                            message.error('用户名或密码错误')\r\n                        }\r\n                    })\r\n                }\r\n                \r\n                // message.success('登陆成功')\r\n                // //replace跳转到页面\r\n                // \r\n            };\r\n\r\n            onFinishFailed = (errorInfo) => {\r\n                console.log(errorInfo)\r\n                message.error('登陆出错,请重试')\r\n            };\r\n\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"login-bg\">\r\n                <div className=\"login-content\">\r\n                    <img src={close} alt=\"guanbi\" onClick={this.CloseLogin}/>\r\n                    <h2>用户登陆</h2>\r\n                    <Form\r\n                        // layout='inline'\r\n                        labelAlign='left'\r\n                        name=\"basic\"\r\n                        labelCol={{\r\n                            span: 7,\r\n                        }}\r\n                        wrapperCol={{\r\n                            span: 20,\r\n                        }}\r\n                        initialValues={{\r\n                            remember: true,\r\n                        }}\r\n                        onFinish={this.onFinish}\r\n                        onFinishFailed={this.onFinishFailed}\r\n                        autoComplete=\"off\"\r\n                        >\r\n                            <Form.Item\r\n                                label=\"账户\"\r\n                                name=\"username\"\r\n                                rules={[\r\n                                {required: true,message: '用户名不能为空!',},\r\n                                {min: 4,message: '用户名不低于四位',},\r\n                                {max: 12,message: '用户名最长不高于十二位',},\r\n                                {pattern:/^[a-zA-Z0-9_]+$/,message: '用户名必须是英文、数字或下划线组成',},\r\n                                ]}\r\n                            >\r\n                                {/* 高阶函数第二次调用传入的 input↓ */}\r\n                                <Input />  \r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                label=\"密码\"\r\n                                name=\"password\"\r\n                                rules={[\r\n                                {required: true,message: '密码不能为空！',},\r\n                                {min: 4,message: '密码不低于四位',},\r\n                                {max: 12,message: '密码最长不高于十二位',},\r\n                                {pattern:/^[a-zA-Z0-9_]+$/,message: '密码必须是英文、数字或下划线组成',},\r\n                                ]}\r\n                            >\r\n                                <Input.Password />\r\n                            </Form.Item>\r\n\r\n\r\n\r\n                            <Form.Item\r\n                                wrapperCol={{\r\n                                offset: 8,\r\n                                span: 16,\r\n                                }}\r\n                            >\r\n                                <Button type=\"primary\" htmlType=\"submit\" className=\"login-form-button\">\r\n                                    登陆\r\n                                </Button>\r\n                            </Form.Item>\r\n                        </Form>\r\n                </div>\r\n            </div>\r\n            \r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}